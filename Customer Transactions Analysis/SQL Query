SELECT
   InvoiceNo,
   StockCode,
   Description,
   Quantity,
   InvoiceDate,
   UnitPrice,
   CustomerID,
   Country
FROM OnlineRetail LIMIT 10;

-- Check for missing values
SELECT 
    SUM(CASE WHEN Quantity IS NULL THEN 1 ELSE 0 END) AS NullQuantity,
    SUM(CASE WHEN UnitPrice IS NULL THEN 1 ELSE 0 END) AS NullUnitPrice,
    SUM(CASE WHEN Description IS NULL THEN 1 ELSE 0 END) AS NullDescription
FROM OnlineRetail;


-- Create new variable
ALTER TABLE OnlineRetail ADD COLUMN TotalValue REAL;
UPDATE OnlineRetail
SET TotalValue = Quantity * UnitPrice;

-- Calculate total sales per invoice
CREATE TABLE InvoiceTotals AS
SELECT InvoiceNo, SUM(TotalValue) AS TotalSales
FROM OnlineRetail
GROUP BY InvoiceNo;

-- Identify which countries generate the most revenue:
SELECT Country, SUM(TotalValue) AS TotalSales
FROM OnlineRetail
GROUP BY Country
ORDER BY TotalSales DESC;

-- Analyze sales trends by month or year:
-- Extract year and month from InvoiceDate
CREATE TABLE MonthlySales AS
SELECT strftime('%Y', InvoiceDate) AS Year,
       strftime('%m', InvoiceDate) AS Month,
       SUM(TotalValue) AS MonthlySales
FROM OnlineRetail
GROUP BY Year, Month
ORDER BY Year, Month;

-- Analyze average spending per customer:
SELECT Description, SUM(TotalValue) AS TotalSales
FROM OnlineRetail
GROUP BY Description
ORDER BY TotalSales DESC
LIMIT 10;

-- Customer Purchasing Patterns:
SELECT CustomerID, SUM(TotalValue) AS TotalSpent
FROM OnlineRetail
GROUP BY CustomerID
ORDER BY TotalSpent DESC;
